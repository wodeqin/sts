!function(e){window.SelectBoxManager=function(){var t=[],s=this;e(document).click(function(t){0===e(t.target).parents(".customSelect").size()&&s.close()}),this.add=function(e){t.push(e)},this.close=function(){e(t).each(function(){this.close()})}};var t=new SelectBoxManager;window.SelectBox=function(s){function n(){j=!!navigator.userAgent.match(/iPad|iPhone|Android|IEMobile|BlackBerry/i),j&&g.selectbox.addClass("use-default");var e="",s=g.selectbox.attr("class");"undefined"!=typeof g.selectbox.attr("id")&&(e='id="select-'+g.selectbox.attr("id")+'"'),g.selectbox.wrap('<div class="customSelect '+s+'" '+e+" />"),r=g.selectbox.parents(".customSelect"),m=g.selectbox.find("option");var n=['<div class="selectList"><div class="selectListOuterWrap"><div class="selectListInnerWrap"><div class="selectListTop"></div><dl>'];n.push(l()),n.push('</dl><div class="selectListBottom"></div></div></div></div>'),r.append('<div class="selectValueWrap"><div class="selectedValue">'+N+'</div> <span class="caret"></span> </div>'+n.join("")),p=r.find("dl"),u=r.find(".selectedValue"),h=r.find(".selectValueWrap"),f=r.find(".selectList"),r.width(g.width),p.width(g.width-2),a(),t.add(v)}function a(){h.click(function(){L?(g.selectbox.focus(),v.close()):I&&(j?g.selectbox.focus():v.open())}),p.click(function(t){var s=e(t.target);(s.is("dd")||s.parents("dd"))&&("dd"!=t.target.tagName.toLowerCase()&&(s=s.parents("dd")),!s.hasClass(w)&&s.get(0)&&(v.jumpToIndex(s.get(0).className.split(" ")[0].split("-")[1]),v.close(),j||g.selectbox.focus()))}),g.selectbox.focus(function(){T=!0,r.addClass(b)}).blur(function(){T=!1,r.removeClass(b)}),j&&g.selectbox.change(function(){o(e(this).find("option:selected").html())}),g.selectbox.keyup(function(){v.close(),m.each(function(e,t){return t.selected?(v.jumpToIndex(e),!1):void 0})}),c()}function c(){var t=e(".customSelect dd");t.off("mouseover"),t.off("mouseout"),t.on("mouseover",function(t){var s=e(t.target);"dd"!=t.target.tagName.toLowerCase()&&(s=s.parents("dd")),s.addClass(S)}),t.on("mouseout",function(t){var s=e(t.target);"dd"!=t.target.tagName.toLowerCase()&&(s=s.parents("dd")),s.removeClass(S)})}function o(e){u.html()!=e&&(u.html(d(e)),g.changeCallback(g.selectbox.val()))}function l(){var t=[];return m.each(function(s,n){var a=e(this),c=a.parents("optgroup"),o="",l="";c.length>0&&0===a.prev().length&&t.push("<dt>"+c.attr("label")+"</dt>"),""!==n.className&&e(n.className.split(" ")).each(function(){l+='<span class="'+this+'"></span>'}),n.selected&&!n.disabled&&(N=l+"<span>"+d(e(n).html())+"</span>",o=" "+x),n.disabled&&(o+=" "+w),t.push('<dd class="itm-'+s+o+" "+n.className+'">'+l+"<span>"+n.innerHTML+"</span></dd>")}),u&&null!==u.get(0)&&u.html(N),t.join("")}function i(){p.css("height","auto"),g.height&&p.height()>g.height?(p.css("height",g.height),g.customScrollbar?v.scrollpane=p.jScrollPane(e.extend({contentWidth:200},g.scrollOptions)):p.addClass("defaultScrollbar")):p.css({overflow:"hidden"})}function d(e){var t=e.split("</span>"),s=t[t.length-1];t[t.length-1]="";var n=t.join("</SPAN>");return n+g.truncate(s)}var r,u,h,f,p,m,v=this,g=e.extend(!0,{manager:t,customScrollbar:!0,zIndex:100,changeCallback:function(){},truncate:function(e){return e},scrollOptions:{}},s),b="focused",x="selected",C="select-open",w="disabled",S="hovered",j=!1,L=!1,I=!0,T=!1,N="";this.sync=function(){m=g.selectbox.find("option"),p.html(l()),c(),i()},this.disable=function(){I=!1,r.addClass(w),g.selectbox.attr("disabled","disabled")},this.enable=function(){I=!0,r.removeClass(w),g.selectbox.removeAttr("disabled")},this.close=function(){r.removeClass(C),r.css({"z-index":g.zIndex}),L=!1},this.open=function(){i(),g.manager&&g.manager.close(),r.addClass(C),v.scrollpane&&v.scrollpane.data("jsp").scrollToY(r.find(".selected").position().top),r.css({"z-index":g.zIndex+1}),L=!0},this.jumpToIndex=function(e){g.selectbox.get(0).selectedIndex=e,r.find(".selected").removeClass(x),r.find(".itm-"+e).addClass(x),o(r.find(".itm-"+e).html())},this.jumpToValue=function(e){var t=-1;return m.each(function(s){return this.innerHTML==e?(t=s,!1):void 0}),-1!=t&&v.jumpToIndex(t),t},n()}}(jQuery);